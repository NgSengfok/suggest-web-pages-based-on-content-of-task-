<!DOCTYPE html>
<html>
	<head>
		<title>background</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<script type="text/javascript">
chrome.extension.onRequest.addListener(
	function (request, sender, sendResponse) 
	{
		console.log(sender.tab ? 
					"from a content script: " + sender.tab.url :
					"from the extension");
		
		if (request.greeting == "hello")
			sendResponse({farewell: "goodbye"});
		else 
			sendResponse({});
	}
);

chrome.tabs.onCreated.addListener(function (tab){
	console.log('create tab: %o', tab);
});

chrome.tabs.onUpdated.addListener(function (tab_id, change_info, tab) {
	
	console.log('updated tab');
	console.log('tab id: %o; chang info: %o; tab: %o', tab_id, change_info, tab);
	if (change_info.status == 'complete')
	{
		var request = {operate: 'get-page-info'};

		console.log('Send request(%o) to tab(%o)', request, tab.id);

		chrome.tabs.sendRequest(tab.id, request, function (response) {
			console.log('Receive response: %o', response);	
		});
	}
});
		</script>
	</body>
</html>

<!-- End of file background.html -->
